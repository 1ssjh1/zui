/*!
 * ZUI: 思维导图 - v1.10.0 - 2022-05-20
 * http://openzui.com
 * GitHub: https://github.com/easysoft/zui.git 
 * Copyright (c) 2022 cnezsoft.com; Licensed MIT
 */
!function(t,e,i,o,n){"use strict";var a=0,d=function(t){var o,n=i,a=t[0];if(n.body.createTextRange)o=i.body.createTextRange(),o.moveToElementText(a),o.select();else if(e.getSelection){var d=e.getSelection();o=i.createRange(),o.selectNodeContents(a),d.removeAllRanges(),d.addRange(o)}},s=function(e,i){this.$=t(e),this.options=this.getOptions(i),this.lang=this.getLang(),this.data=this.options.data,this.dirtyData=!0,this.offsetX=0,this.offsetY=0,this.init(),this.options.hotkeyEnable||t.zui.messager.show(this.lang.hotkeyDisabled)};s.DEFAULTS={hotkeyEnable:!0,hotkeys:{selectPrev:"Up",selectNext:"Down",selectLeft:"left",selectRight:"right",deleteNode:"del backspace",addBrother:"return",addChild:"tab insert",centerCanvas:"space",toggleNode:"+ -"},lang:"zh_cn",langs:{zh_cn:{defaultName:"灵光闪现",defaultSubName:"灵光",defaultNodeName:"闪现",readonlyTip:"该节点已被设置为只读，无法进行编辑。",hotkeyDisabled:'快捷键不可用，需要 <a target="_blank" href="https://github.com/jeresig/jquery.hotkeys">jquery.hotkeys</a> 插件支持。'}},data:{text:"New Project",type:"root",collapesed:!1,theme:"default",caption:"",id:t.zui.uuid()+""},nodeTeamplate:"<div id='node-{id}' class='mindmap-node' data-type='{type}' data-id='{id}' data-parent='{parent}'><div class='wrapper'><div class='text'>{text}</div><div class='caption'>{caption}</div><div class='btn-toggle'></div></div></div>",hSpace:100,vSpace:10,canvasPadding:20,removingNodeTip:null,lineCurvature:60,subLineWidth:4,lineColor:"rainbow",lineOpacity:1,lineSaturation:90,lineLightness:40,nodeLineWidth:2,showToggleButton:!1,readonly:!1},s.prototype.getOptions=function(e){return s.DEFAULTS.data.text=s.DEFAULTS.langs.zh_cn.defaultName,e=t.extend({},s.DEFAULTS,this.$.data(),e),e.hotkeyEnable=e.hotkeyEnable&&t.hotkeys!==n,e},s.prototype.getLang=function(){var i=this.options;if(!i.lang){if(e.config!==n&&e.config.clientLang)i.lang=config.clientLang;else{var o=t("html").attr("lang");i.lang=o?o:"en"}i.lang=i.lang.replace(/-/,"_").toLowerCase()}var a=i.langs[i.lang]||i.langs[s.DEFAULTS.lang];return i.defaultSubName&&(a.defaultSubName=i.defaultSubName),i.defaultNodeName&&(a.defaultNodeName=i.defaultNodeName),a},s.prototype.init=function(){this.initDom(),this.initSize(),this.bindEvents(),this.render()},s.prototype.initDom=function(){var e=this.$;e.attr("id")||e.attr("id","mindmap-"+t.zui.uuid()),this.id=e.attr("id"),this.$container=e.children(".mindmap-container"),this.$container.length||(e.prepend("<div class='mindmap-container'></div>"),this.$container=e.children(".mindmap-container")),this.$canvas=this.$container.children("canvas"),this.$canvas.length||(this.$container.prepend("<canvas class='mindmap-bg'></canvas>".format(this.options.canvasSize)),this.$canvas=this.$container.children("canvas")),this.$desktop=this.$container.children(".mindmap-desktop"),this.$desktop.length||(this.$container.append("<div class='mindmap-desktop'></div>"),this.$desktop=this.$container.children(".mindmap-desktop")),this.$desktop.attr("unselectable","on").toggleClass("mindmap-show-toggle-btn",!!this.options.showToggleButton)},s.prototype.initSize=function(){var t=this.$;this.winWidth=t.width(),this.winHeight=t.height(),this.centerX=o.floor(this.winWidth/2),this.centerY=o.floor(this.winHeight/2),this.dirtyData||this.display()},s.prototype.callEvent=function(e,i){return t.zui.callEvent(this.options[e],i,this)},s.prototype.computePosition=function(t,e){var i=e?-1:1;return t.left!==n&&(t.left-=(this.left-this.options.canvasPadding)*i),t.top!==n&&(t.top-=this.top*i),t.x!==n&&(t.x-=(this.left-this.options.canvasPadding)*i),t.y!==n&&(t.y-=this.top*i),t},s.prototype.computeColor=function(e,i){return e instanceof t.zui.Color||(e=new t.zui.Color(e)),"number"==typeof i&&e.fade(i),e.toCssStr()},s.prototype.getNodeData=function(t,e){if("number"==typeof t&&(t=t.toString()),e||(e=this.data),t==e.id)return e;if(Array.isArray(e.children)&&e.children.length>0)for(var i in e.children){var o=this.getNodeData(t,e.children[i]);if(o)return o}return null},s.prototype.createDefaultNodeData=function(e){var i={collapesed:!1,id:t.zui.uuid()+"",parent:e.id};return"root"===e.type?(i.type="sub",i.text=this.lang.defaultSubName):(i.type="node",i.text=this.lang.defaultNodeName),i},s.prototype.getNode=function(t){return"string"==typeof t?this.$desktop.children('[data-id="'+t+'"]'):t.id!==n?t.ui.element:void 0},s.prototype.removeNode=function(t){if(this.getNode(t).remove(),t.count>0)for(var e in t.children)this.removeNode(t.children[e])},s.prototype.toggleNode=function(t,e){var i=this;"focused"===t&&(t=i.activeNode.id);var o="string"==typeof t?i.getNodeData(t):t;if(o&&"root"!==o.type){if(e===n&&(e=!o.collapesed),i.update({data:o,action:"update",collapesed:e}),e&&o.children&&o.children.length){var a=function(t){for(var e=0;e<t.length;++e){var o=t[e];i.getNode(o).remove(),o.children&&o.children.length&&a(o.children)}};a(o.children)}return e}},s.prototype.update=function(e,i,o){var a=!1;this.options;if(t.isPlainObject(e)&&(e=[e]),Array.isArray(e))for(var d in e){var s=e[d],r=s.data;if(r||(r=this.getNodeData(s.id)),!r||r.readonly)return;var l=s.action||"update";if("remove"===l||"delete"===l){var h=this.getNodeData(r.parent);h&&(h.children.splice(r.index,1),this.removeNode(r),this.clearNodeStatus(),"add"!==r.changed&&(Array.isArray(h.deletions)?h.deletions.push(r):h.deletions=[r],r.changed="delete",h.changed="delete children"),o=!0,i=!0,a=!0)}else if("add"===l)Array.isArray(r.children)?r.children.push(s.newData):r.children=[s.newData],r.count+=1,s.newData.index=r.count,s.newData.changed="add",o=!0,i=!0,a=!0;else if("move"===l){if(s.newParent!==r.parent){var c=this.getNodeData(s.newParent),h=this.getNodeData(r.parent);h&&c&&("root"===c.type?("node"===r.type&&(r.color=null),r.type="sub",r.subSide=null):(r.type="node",r.subSide=c.subSide),h.children.splice(r.index,1),h.count-=1,Array.isArray(c.children)?c.children.push(r):c.children=[r],c.count+=1,r.index=c.count,o=!0,i=!0,a=!0,"add"!==r.changed&&(r.changed="move"))}}else if("sort"===l){if(r.count>1){r.children.sort(s.func);for(var d in r.children){var p=r.children[d];p.index!==d&&(p.index=d,"add"!==p.changed&&(p.changed="sort"),o=!0,i=!0,a=!0)}}}else s.text!==n&&s.text!==r.text&&(r.text=s.text,i=!0,a=!0),s.collapesed!==n&&s.collapesed!==r.collapesed&&(r.collapesed=s.collapesed,o=!0,i=!0,a=!0),s.subSide!==n&&s.subSide!==r.subSide&&(r.subSide=s.subSide,o=!0,i=!0,a=!0),a&&"add"!==r.changed&&(r.changed="edit")}o&&this.loadNode(),i&&this.showNode(),a&&this.callEvent("onChange",{changes:e,data:this.data})},s.prototype.clearChangeFlag=function(t){if(t===n&&(t=this.data),t.changed&&(t.changed=null),t.children)for(var e in t.children)this.clearChangeFlag(t.children[e])},s.prototype.exportData=function(){var e=t.extend({},this.data);return this.fixExport(e),e},s.prototype.exportJSON=function(){return JSON.stringify(this.exportData())},s.prototype.exportArray=function(e,i){e===n&&(e=this.data),i===n&&(i=[]);var o=t.extend({},e);if(delete o.ui,delete o.children,delete o.subSide,i.push(o),e.children)for(var a in e.children)this.exportArray(e.children[a],i);return i},s.prototype.fixExport=function(t){if(delete t.ui,t.children)for(var e in t.children)this.fixExport(t.children[e])},s.prototype.load=function(t){this.data=t,this.render(t)},s.prototype.render=function(){this.loadNode(),this.showNode()},s.prototype.loadNode=function(e,i,d){e||(e=this.data);var s=this.options,r=this.$desktop,l="object"==typeof i&&i.id?i.id:"";e.collapesed===n&&(e.collapesed=!1),e.data===n&&(e.data={}),e.type===n&&(e.type="node"),e.id===n&&(e.id=t.zui.uuid()+""),e.readonly===n&&(e.readonly=!1),e.ui===n&&(e.ui={}),e.parent=l;var h=r.children('.mindmap-node[data-id="'+e.id+'"]');if(h.length?(h.toggleClass("mindmap-collapesed",!!e.collapesed).toggleClass("mindmap-expanded",!e.collapesed).toggleClass("mindmap-has-child",!(!e.children||!e.children.length)).attr("data-type",e.type).attr("data-parent",l||"root"),h.children(".text").html(e.text),h.children(".caption").html(e.caption)):(h=t(s.nodeTeamplate.format({type:e.type||"node",collapesed:e.collapesed,caption:e.caption||"",id:e.id,parent:l||"root",text:e.text})).toggleClass("mindmap-collapesed",!!e.collapesed).toggleClass("mindmap-expanded",!e.collapesed).appendTo(r).toggleClass("mindmap-has-child",!(!e.children||!e.children.length)),this.bindNodeEvents(h),e.ui.element=h),"root"===e.type)e.ui.subLeftSide=0,e.ui.subRightSide=0,e.ui.vLeftSpan=0,e.ui.vRightSpan=0;else if("sub"===e.type){var c=e.subSide;c||(c=i.ui.subRightSide>i.ui.subLeftSide?"left":"right"),"left"===c?i.ui.subLeftSide++:i.ui.subRightSide++,e.subSide=c,e.color===n&&(e.color={h:o.floor(43*a++%360),s:this.options.lineSaturation/100,l:this.options.lineLightness/100,a:this.options.lineOpacity})}else e.subSide=i.subSide;h.data("origin-text",e.text).data("node",e).toggleClass("readonly",e.readonly).toggleClass("mindmap-side-left","left"===e.subSide).toggleClass("mindmap-side-right","right"===e.subSide),e.className&&h.addClass(e.className);var p=1;if(e.count=0,!e.collapesed&&e.children&&e.children.length>0){e.ui.topSpanTemp="root"===e.type?{left:0,right:0}:0;var u=0,f=0,v=null;p=0,e.children.sort(function(t,e){return t.index-e.index});for(var g in e.children){var y=e.children[g];y.ui===n&&(y.ui={}),"sub"!==y.type&&y.color===n&&(y.color=e.color),y.ui.nextBrother=null,v?(y.ui.prevBrother=v.id,v.ui.nextBrother=y.id):y.ui.prevBrother=null,v=y,this.loadNode(y,e,g),y.index=e.count++,y.order===n&&(y.order=y.index),p+=y.ui.vSpan,"sub"===y.type?"left"===y.subSide?(u+=y.ui.vSpan,y.ui.topSpan=e.ui.topSpanTemp.left,e.ui.topSpanTemp.left+=y.ui.vSpan):(f+=y.ui.vSpan,y.ui.topSpan=e.ui.topSpanTemp.right,e.ui.topSpanTemp.right+=y.ui.vSpan):(y.ui.topSpan=e.ui.topSpanTemp,e.ui.topSpanTemp+=y.ui.vSpan)}"root"===e.type&&(e.ui.vLeftSpan=u,e.ui.vRightSpan=f)}"root"!==e.type&&(e.ui.vSpan=p),this.dirtyData=!1,"root"===e.type&&this.callEvent("afterLoad",{data:e,$node:h})},s.prototype.showNode=function(e,i,n){e||(e=this.data);var a=this.options,d=e.ui,s=e.ui.element;if(d.width=s.outerWidth(),d.height=s.outerHeight(),"root"===e.type)d.left=0-o.floor(d.width/2),d.top=0-o.floor(d.height/2),this.left=0-o.floor(o.max(d.width+a.canvasPadding,this.winWidth)/4),this.right=0-this.left,this.top=0-o.floor(o.max(d.height+a.canvasPadding,this.winHeight)/4),this.bottom=0-this.top;else if(t.isPlainObject(d.dragPos))d.left=d.dragPos.left,d.top=d.dragPos.top;else{if("sub"===e.type){var r=0;"left"===e.subSide?(d.left=i.ui.left-a.hSpace-20-d.width,r=i.ui.vLeftSpan):(d.left=i.ui.left+i.ui.width+a.hSpace+20,r=i.ui.vRightSpan);var l=r*d.height+(r-1)*a.vSpace,h=0-o.floor(l/2),c=d.topSpan*d.height+d.topSpan*a.vSpace,p=d.vSpan*d.height+(d.vSpan-1)*a.vSpace;d.top=h+c+o.floor((p-d.height)/2)}else{"left"===e.subSide?d.left=i.ui.left-a.hSpace-d.width:d.left=i.ui.left+i.ui.width+a.hSpace;var l=i.ui.vSpan*d.height+(i.ui.vSpan-1)*a.vSpace,h=i.ui.top+o.floor(i.ui.height/2)-o.floor(l/2),c=d.topSpan*d.height+d.topSpan*a.vSpace,p=d.vSpan*d.height+(d.vSpan-1)*a.vSpace;d.top=h+c+o.floor((p-d.height)/2)}"left"===e.subSide?this.left=o.min(this.left,d.left):this.right=o.max(this.right,d.left+d.width),this.top=o.min(this.top,d.top),this.bottom=o.max(this.bottom,d.top+d.height)}if(!e.collapesed&&e.children&&e.children.length>0)for(var u in e.children)this.showNode(e.children[u],e,n||e.collapesed);if("root"===e.type){var f=this.options.canvasPadding;this.left-=f,this.top-=f,this.right+=2*f,this.bottom+=f,this.width=this.right-this.left,this.height=this.bottom-this.top,this.display(),this.draw(),this.callEvent("afterShow",{data:e})}},s.prototype.display=function(t,e,i){"number"==typeof t&&"number"==typeof e&&(i&&(t+=this.offsetX,e+=this.offsetY),this.offsetX=t,this.offsetY=e),this.x=this.centerX+this.left+this.offsetX,this.y=this.centerY+this.top+this.offsetY,this.$container.css({width:this.width,height:this.height,top:this.y,left:this.x});var o=this.options.canvasPadding;this.$.toggleClass("shadow-left",this.x<0-o).toggleClass("shadow-right",this.x+this.width>this.winWidth+o).toggleClass("shadow-top",this.y<0-o).toggleClass("shadow-bottom",this.y+this.height>this.winHeight+o)},s.prototype.makeNodeVisble=function(t){var e=this.getNodeData(t.data("id"));if(e){var i=e.ui.left-this.left+this.x,o=e.ui.top-this.top+this.y,n=this.options.canvasPadding;if(i<0)this.offsetX+=0-i;else{var a=i+e.ui.width-(this.winWidth+n);a>0&&(this.offsetX+=0-a-80)}if(o<0)this.offsetY+=0-o;else{var a=o+e.ui.height-(this.winWidth+n);a>0&&(this.offsetY+=0-a-80)}this.display()}},s.prototype.clearCanvasArea=function(t,e){this.$canvas[0].getContext("2d").clearRect(0,0,this.width,this.height)},s.prototype.draw=function(t,e,i){if(t||(t=this.data),"root"===t.type&&(this.$canvas.attr({width:this.width,height:this.height}),this.clearCanvasArea()),e){if(i)return;var n="left"===t.subSide,a=this.options,d=this.$canvas[0].getContext("2d"),s={x:e.ui.left+("root"===e.type?o.floor(e.ui.width/2):n?0:e.ui.width),y:e.ui.top+o.floor(e.ui.height/2)},r={x:t.ui.left+(n?t.ui.width:0),y:t.ui.top+o.floor(t.ui.height/2)},l={x:s.x+(n?-1:1)*a.lineCurvature,y:s.y},h={x:r.x+(n?1:-1)*a.lineCurvature,y:r.y};s=this.computePosition(s),r=this.computePosition(r),l=this.computePosition(l),h=this.computePosition(h),d.beginPath(),d.strokeStyle=this.computeColor(t.color,t.ui.canDrop?25:100),d.lineCap="round",d.lineWidth="sub"===t.type?a.subLineWidth:a.nodeLineWidth,d.moveTo(s.x,s.y),d.bezierCurveTo(l.x,l.y,h.x,h.y,r.x,r.y),d.stroke()}if(t.ui.element.css(this.computePosition({left:t.ui.left,top:t.ui.top})),!t.collapesed&&t.children&&t.children.length>0)for(var c in t.children)this.draw(t.children[c],t,i||t.collapesed)},s.prototype.bindNodeEvents=function(e){var i,o=this;e.on("click",function(i){var n=t(i.target);return n.hasClass("btn-toggle")?o.toggleNode(e.data("id")):void o.onNodeClick(i,e)}).mousedown(function(t){t.stopPropagation()}),o.options.readonly||(e.find(".text").on("keyup paste blur",function(t){o.onNodeTextChanged(t,e)}),"root"!==e.data("type")&&e.droppable({container:o.$,target:"#"+o.id+' .mindmap-node:not([data-id="'+e.data("id")+'"])',before:function(t){return!!o.callEvent("beforeDrag",{node:e})&&(!t.element.hasClass("focus")&&(i=o.getNodeData(t.element.data("id")),!!i&&void 0))},start:function(t){o.callEvent("startDrag",{node:e}),t.element.hasClass("active")||(o.clearNodeStatus(),o.activeNode(e))},drag:function(t){t.position.left-=o.x,t.position.top-=o.y,i.ui.dragPos=o.computePosition(t.position,!0),i.ui.canDrop=t.isIn,o.showNode()},beforeDrop:function(t){if(t.isIn){if(t.target.data("id")==i.parent)return!1}else{if(!o.callEvent("beforeSort",{node:e,event:t}))return;var n=i.subSide;"sub"===i.type&&(i.ui.left<-30?n="left":i.ui.left>30&&(n="right")),o.update([{action:"sort",data:o.getNodeData(i.parent),func:function(t,e){return t.ui.top-e.ui.top}},{data:i,subSide:n}]),o.callEvent("afterSort",{node:e,event:t})}},drop:function(t){o.callEvent("beforeMove",{node:i,event:t})&&(o.update({action:"move",data:i,newParent:t.target.data("id")}),o.callEvent("afterMove",{node:i,event:t}))},finish:function(t){i.ui.dragPos=null,i.ui.canDrop=!1,o.showNode()}})),this.callEvent("onBindEvents",{node:e})},s.prototype.onNodeClick=function(t,e){e.hasClass("active")?this.focusNode(e):(this.clearNodeStatus(),this.activeNode(e)),this.callEvent("onNodeClick",{node:e}),t.stopPropagation()},s.prototype.onNodeTextChanged=function(t,e){var i=e.find(".text"),o=i.text();o!==e.data("origin-text")&&(""===o&&i.text(""),e.data("origin-text",o),this.update({id:e.data("id"),text:o}),this.callEvent("onTextChanged",{node:e,text:o})),"blur"===t.type&&i.text(o)},s.prototype.activeNode=function(t){t===n&&(t=this.$desktop.children('.mindmap-node[data-type="sub"]').first()),t.length||(t=this.$desktop.children(".mindmap-node").first()),this.callEvent("beforeNodeActive",{node:t})&&(t.addClass("active"),this.makeNodeVisble(t),this.activedNode=t,this.isActive=!0,this.callEvent("onNodeActive",{node:t}))},s.prototype.focusNode=function(e,i){if(!this.options.readonly){if(e.hasClass("readonly"))return void t.zui.messager.show(this.lang.readonlyTip);if(e.hasClass("active")&&this.callEvent("beforeNodeFocus",{node:e})){var o=e.addClass("focus").find(".text");o.attr("contenteditable","true"),this.makeNodeVisble(e),o.focus(),(i||i===n)&&d(o),this.isFocus=!0}}},s.prototype.clearActiveNode=function(t){t===n&&(t=this.$desktop.children(".mindmap-node.active")),t.removeClass("active"),this.isActive=!1,this.activedNode=null},s.prototype.clearFocusNode=function(t){t===n&&(t=this.$desktop.children(".mindmap-node.focus")),t.removeClass("focus").find(".text").attr("contenteditable","false").blur(),this.isFocus=!1},s.prototype.bindEvents=function(){var t=this.$,e=this;t.resize(this.initSize.bind(this)).click(this.onDesktopClick.bind(this)),this.bindGlobalHotkeys(),this.$container.draggable({before:function(t){if(!e.callEvent("beforeMoveCanvas"))return!1},finish:function(t){e.display(t.smallOffset.x,t.smallOffset.y,!0)},drag:function(t){e.display(t.smallOffset.x,t.smallOffset.y,!0)}})},s.prototype.bindGlobalHotkeys=function(){var e=this.options;if(e.hotkeyEnable){var o=this,n=e.hotkeys;t(i).on("keydown",null,n.selectPrev,function(){o.callEvent("beforeHotkey",{event:event,hotkey:n.selectPrev})&&o.selectNode("prev")}).on("keydown",null,n.selectNext,function(){o.callEvent("beforeHotkey",{event:event,hotkey:n.selectNext})&&o.selectNode("next")}).on("keydown",null,n.selectLeft,function(){o.callEvent("beforeHotkey",{event:event,hotkey:n.selectLeft})&&o.selectNode("left")}).on("keydown",null,n.selectRight,function(){o.callEvent("beforeHotkey",{event:event,hotkey:n.selectRight})&&o.selectNode("right")}).on("keydown",null,n.toggleNode,function(t){o.callEvent("beforeHotkey",{event:event,hotkey:n.toggleNode})&&o.toggleNode("focused")}).on("keydown",null,n.centerCanvas,function(){o.callEvent("beforeHotkey",{event:event,hotkey:n.centerCanvas})&&o.display(0,0)}),o.options.readonly||t(i).on("keydown",null,n.deleteNode,function(){o.callEvent("beforeHotkey",{event:event,hotkey:n.deleteNode})&&(o.deleteNode(),8!=event.keyCode||o.isFocus||event.preventDefault())}).on("keydown",null,n.addBrother,function(){o.callEvent("beforeHotkey",{event:event,hotkey:n.addBrother})&&o.addBrotherNode()}).on("keydown",null,n.addChild,function(t){o.callEvent("beforeHotkey",{event:t,hotkey:n.addChild})&&(o.addChildNode(),9==t.keyCode&&t.preventDefault())}).on("keydown",function(){if(o.callEvent("beforeHotkey",{event:event,type:"keydown"})&&event.keyCode>=48&&event.keyCode<=111&&o.isActive&&!o.isFocus){var t=o.activedNode;t&&(t.find(".text").text(""),o.focusNode(t))}})}},s.prototype.addBrotherNode=function(){if(this.isActive){var t=this.getNodeData(this.activedNode.data("id"));if(t){var e="root"===t.type?t:this.getNodeData(t.parent),i=this.createDefaultNodeData(e);if(!this.callEvent("beforeAdd",{node:e,newNode:i}))return;this.update({action:"add",data:e,newData:i}),this.clearNodeStatus();var o=this.getNode(i.id);this.activeNode(o),this.focusNode(o,!0),this.callEvent("afterAdd",{node:e,newNode:i})}}},s.prototype.addChildNode=function(){if(this.isActive){var t=this.getNodeData(this.activedNode.data("id"));if(t){var e=this.createDefaultNodeData(t);if(!this.callEvent("beforeAdd",{node:t,newNode:e}))return;this.update({action:"add",data:t,newData:e}),this.clearNodeStatus();var i=this.getNode(e.id);this.activeNode(i),this.focusNode(i,!0),this.callEvent("afterAdd",{node:t,newNode:e})}}},s.prototype.deleteNode=function(){if(!this.isFocus&&this.isActive){var t=this.getNodeData(this.activedNode.data("id"));if(t){if(!this.callEvent("beforeDelete",{node:t}))return;this.update({action:"remove",data:t}),this.callEvent("afterDelete",{node:t})}}},s.prototype.selectNode=function(t){if(!this.isFocus){if(!this.isActive)return void this.activeNode();var e=null,i=this.getNodeData(this.activedNode.data("id")),o=null;switch("root"===i.type?t="prev"===t||"left"===t?"left":"right":"left"===t?t="left"==i.subSide?"child":"parent":"right"===t&&(t="right"==i.subSide?"child":"parent"),t){case"prev":o=i.ui.prevBrother;break;case"next":o=i.ui.nextBrother;break;case"parent":o=i.parent;break;case"child":i.count>0&&!i.collapesed&&(o=i.children[0].id);break;case"left":if(i.count>0&&!i.collapesed){o=i.children[0].id;for(var n in i.children){var a=i.children[n];if("left"==a.subSide){o=a.id;break}}}break;case"right":if(i.count>0&&!i.collapesed){o=i.children[0].id;for(var n in i.children){var a=i.children[n];if("right"==a.subSide){o=a.id;break}}}}o&&(e=this.getNodeData(o)),e&&(this.clearNodeStatus(),this.activeNode(e.ui.element))}},s.prototype.selectNext=function(){if(!this.isFocus){var t=null;this.isActive||this.activeNode();var e=this.getNodeData(this.activedNode.data("id"));null!==e.ui.nextBrother&&(t=this.getNodeData(e.ui.nextBrother)),t&&(this.clearNodeStatus(),this.activeNode(t.ui.element))}},s.prototype.selectLeft=function(){if(!this.isFocus){var t=null;this.isActive||this.activeNode();var e=this.getNodeData(this.activedNode.data("id"));null!==e.ui.leftBrother&&(t=this.getNodeData(e.ui.leftBrother)),t&&(this.clearNodeStatus(),this.activeNode(t.ui.element))}},s.prototype.onDesktopClick=function(){this.$desktop;this.clearNodeStatus()},s.prototype.clearNodeStatus=function(){this.clearActiveNode(),this.clearFocusNode()},t.fn.mindmap=function(e){return this.each(function(){var i=t(this),o=i.data("zui.mindmap"),n="object"==typeof e&&e;o||i.data("zui.mindmap",o=new s(this,n)),"string"==typeof e&&o[e]()})},t.fn.mindmap.Constructor=s}(jQuery,window,document,Math,void 0);